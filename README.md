# å®¶æ ¡äº’è”é—®å·ç³»ç»Ÿ

è¿™æ˜¯ä¸€å¥—åŸºäº Deno + Oak + Prisma + Vue3 + Ant Design æ­å»ºçš„é—®å·ç³»ç»Ÿï¼Œç”¨äºå­¦æ ¡å’Œå®¶é•¿ä¹‹é—´çš„é—®å·è°ƒç ”ã€‚

## åŠŸèƒ½ç‰¹è‰²

### ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½
- **é—®å·ç®¡ç†**: æ ¡æ–¹å¯ä»¥åˆ›å»ºã€æŸ¥çœ‹å’Œç®¡ç†é—®å·
- **å¤šé—®å·æ”¯æŒ**: åŒæ—¶æ”¯æŒå¤šä¸ªé—®å·å¹¶å­˜ï¼Œæ¯ä¸ªé—®å·æœ‰ç‹¬ç«‹çš„ç»“æœé¡µé¢
- **åˆ†é¡µå±•ç¤º**: é—®å·åˆ—è¡¨å’Œç»“æœé¡µé¢éƒ½æ”¯æŒåˆ†é¡µï¼Œé€‚åˆå¤§é‡æ•°æ®
- **å®æ—¶ç»Ÿè®¡**: å¯æŸ¥çœ‹é—®å·æ”¶é›†æ•°é‡å’Œè¯¦ç»†ç»“æœ
- **å…æ³¨å†Œç­”é¢˜**: å®¶é•¿åªéœ€è¾“å…¥å§“åå’Œå­¦å·å³å¯å‚ä¸

### ğŸ¯ é—®å·ç‰¹æ€§
- **å­¦æœŸç®¡ç†**: æ”¯æŒå­¦å¹´ã€å­¦æœŸï¼ˆä¸Š/ä¸‹å­¦æœŸï¼‰ã€å‘¨æ¬¡ç­‰æ—¶é—´å±æ€§
- **å¤šç§é¢˜å‹**: æ”¯æŒæ˜Ÿçº§è¯„åˆ†ï¼ˆ0-5æ˜Ÿï¼‰å’Œæ–‡æœ¬è¾“å…¥é¢˜å‹
- **ä¸€äººä¸€ç¥¨**: åŒä¸€ç”¨æˆ·åªèƒ½å¯¹åŒä¸€é—®å·æäº¤ä¸€æ¬¡ç­”æ¡ˆ
- **é“¾æ¥åˆ†äº«**: é—®å·å¯é€šè¿‡ URL ç›´æ¥åˆ†äº«ï¼ŒåŒ…å«é—®å·ID

## æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **è¿è¡Œæ—¶**: Deno
- **Webæ¡†æ¶**: Oak
- **æ•°æ®åº“ORM**: Prisma
- **æ•°æ®åº“**: PostgreSQL
- **è¯­è¨€**: TypeScript

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue 3 + Composition API
- **UIåº“**: Ant Design Vue
- **è·¯ç”±**: Vue Router
- **æ„å»ºå·¥å…·**: Vite
- **è¯­è¨€**: TypeScript

## æ•°æ®åº“è®¾è®¡

```sql
-- ç”¨æˆ·è¡¨
User {
  id: number (PK)
  name: string
  id_number: string  // å­¦å·
  role: number       // 1=å­¦ç”Ÿ, 10=è€å¸ˆ
}

-- é—®å·è¡¨  
Survey {
  id: number (PK)
  title: string
  description?: string
  year: string       // å­¦å¹´ï¼Œå¦‚ "2023-2024"
  semester: number   // 1=ä¸Šå­¦æœŸ, 2=ä¸‹å­¦æœŸ
  week: number       // å‘¨æ¬¡
  created_at: DateTime
}

-- é—®é¢˜è¡¨
Question {
  id: number (PK)
  survey_id: number (FK)
  description?: string
  config: JSONB      // é—®é¢˜é…ç½®ï¼ŒåŒ…å«ç±»å‹å’Œå‚æ•°
}

-- ç­”æ¡ˆè¡¨
Answer {
  id: number (PK)
  question_id: number (FK)
  submission_id: number (FK)
  value: string      // ç»Ÿä¸€å­˜å‚¨ä¸ºå­—ç¬¦ä¸²
}

-- æäº¤è®°å½•è¡¨
Submission {
  id: number (PK)
  survey_id: number (FK)
  user_id: number (FK)
  created_at: DateTime
  
  UNIQUE(survey_id, user_id)  // ç¡®ä¿ä¸€äººä¸€ç¥¨
}
```

## å¿«é€Ÿå¼€å§‹

### âš¡ å¿«é€Ÿå¯åŠ¨ï¼ˆå¼€å‘æ¨¡å¼ï¼‰

**é‡è¦ï¼šéœ€è¦åŒæ—¶å¯åŠ¨åç«¯å’Œå‰ç«¯æœåŠ¡å™¨ï¼**

```bash
# 1. å¯åŠ¨åç«¯æœåŠ¡å™¨ï¼ˆåœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ï¼‰
cd server
deno task db:generate  # é¦–æ¬¡è¿è¡Œéœ€è¦
deno task dev

# 2. å¯åŠ¨å‰ç«¯æœåŠ¡å™¨ï¼ˆåœ¨ç¬¬äºŒä¸ªç»ˆç«¯ï¼‰
cd client
npm install  # é¦–æ¬¡è¿è¡Œéœ€è¦
npm run dev
```

ç„¶åè®¿é—®ï¼šhttp://localhost:5173

### ç¯å¢ƒè¦æ±‚
- Deno 1.40+
- Node.js 18+
- PostgreSQL 13+ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼‰

### å®Œæ•´å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd StuHomeSchoolSurvey
```

2. **è®¾ç½®æ•°æ®åº“**
```bash
# å¯åŠ¨ PostgreSQLï¼ˆæˆ–ä½¿ç”¨ Dockerï¼‰
# åˆ›å»ºæ•°æ®åº“
createdb survey_system

# é…ç½®ç¯å¢ƒå˜é‡
cp server/.env.example server/.env
# ç¼–è¾‘ server/.env æ–‡ä»¶ï¼Œè®¾ç½®æ­£ç¡®çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
```

3. **åˆå§‹åŒ–åç«¯**
```bash
cd server

# å®‰è£…ä¾èµ–
npm install --save-dev prisma

# ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
deno task db:generate

# æ¨é€æ•°æ®åº“ç»“æ„
deno task db:push

# å¯åŠ¨åç«¯æœåŠ¡
deno task dev
```

4. **åˆå§‹åŒ–å‰ç«¯**
```bash
cd client

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

5. **è®¿é—®åº”ç”¨**
- å‰ç«¯ç®¡ç†ç•Œé¢: http://localhost:5173/admin
- APIæœåŠ¡: http://localhost:8000
- ç­”é¢˜ç•Œé¢: http://localhost:5173/survey/:id

## API æ¥å£

### é—®å·ç®¡ç†
- `GET /api/surveys?page=1&limit=10` - è·å–é—®å·åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
- `POST /api/surveys` - åˆ›å»ºæ–°é—®å·
- `GET /api/surveys/:id` - è·å–é—®å·è¯¦æƒ…
- `GET /api/surveys/:id/results?page=1&limit=20` - è·å–é—®å·ç»“æœï¼ˆåˆ†é¡µï¼‰

### ç­”å·æäº¤
- `POST /api/submissions` - æäº¤é—®å·ç­”æ¡ˆ

### ç³»ç»Ÿ
- `GET /health` - å¥åº·æ£€æŸ¥

## ä½¿ç”¨æŒ‡å—

### ç®¡ç†å‘˜æ“ä½œ

1. **åˆ›å»ºé—®å·**
   - è®¿é—® `/admin/create`
   - å¡«å†™é—®å·åŸºæœ¬ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€å­¦å¹´ã€å­¦æœŸã€å‘¨æ¬¡ç­‰ï¼‰
   - æ·»åŠ é—®é¢˜ï¼ˆæ”¯æŒæ˜Ÿçº§è¯„åˆ†å’Œæ–‡æœ¬è¾“å…¥ï¼‰
   - è®¾ç½®é—®é¢˜æ˜¯å¦å¿…å¡«

2. **æŸ¥çœ‹é—®å·åˆ—è¡¨**
   - è®¿é—® `/admin`
   - æŸ¥çœ‹æ‰€æœ‰é—®å·ï¼Œæ”¯æŒåˆ†é¡µæµè§ˆ
   - å¤åˆ¶é—®å·é“¾æ¥è¿›è¡Œåˆ†äº«

3. **æŸ¥çœ‹é—®å·ç»“æœ**
   - åœ¨é—®å·åˆ—è¡¨ä¸­ç‚¹å‡»"æŸ¥çœ‹ç»“æœ"
   - æŸ¥çœ‹è¯¦ç»†çš„æäº¤è®°å½•å’Œç»Ÿè®¡æ•°æ®
   - æ”¯æŒåˆ†é¡µæµè§ˆç»“æœ

### ç”¨æˆ·ç­”é¢˜

1. **è®¿é—®é—®å·**
   - é€šè¿‡é—®å·é“¾æ¥ `/survey/:id` è®¿é—®
   - æ— éœ€é¢„å…ˆæ³¨å†Œ

2. **å¡«å†™ä¿¡æ¯**
   - è¾“å…¥å§“åå’Œå­¦å·
   - å›ç­”é—®å·é—®é¢˜

3. **æäº¤ç­”æ¡ˆ**
   - æ£€æŸ¥å¿…å¡«é¡¹
   - æäº¤åä¸å¯é‡å¤æäº¤åŒä¸€é—®å·

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
StuHomeSchoolSurvey/
â”œâ”€â”€ server/              # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ routes/         # API è·¯ç”±
â”‚   â”œâ”€â”€ prisma/         # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ types.ts        # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ db.ts           # æ•°æ®åº“æœåŠ¡
â”‚   â””â”€â”€ main.ts         # å…¥å£æ–‡ä»¶
â”œâ”€â”€ client/              # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/      # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/        # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ router/     # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ types.ts    # å…±äº«ç±»å‹
â”‚   â””â”€â”€ package.json
â””â”€â”€ README.md
```

### ä»£ç é£æ ¼
- ä¿æŒä»£ç ç®€æ´ï¼Œé¿å…è¿‡åº¦è®¾è®¡
- ä½¿ç”¨ TypeScript ç¡®ä¿ç±»å‹å®‰å…¨
- å‰åç«¯å…±äº«ç±»å‹å®šä¹‰
- æ³¨é‡Šä½¿ç”¨ä¸­æ–‡

### æµ‹è¯•
```bash
# åç«¯æµ‹è¯•
cd server
deno test --allow-all

# å‰ç«¯æ„å»ºæµ‹è¯•
cd client
npm run build
```

## ç”Ÿäº§éƒ¨ç½²

1. **æ„å»ºå‰ç«¯**
```bash
cd client
npm run build
```

2. **ç¼–è¯‘åç«¯**
```bash
cd server
deno task build
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
- è®¾ç½®ç”Ÿäº§æ•°æ®åº“è¿æ¥
- é…ç½® CORS ç­‰å®‰å…¨è®¾ç½®

4. **éƒ¨ç½²æ•°æ®åº“**
```bash
npx prisma migrate deploy
```

## è®¸å¯è¯

[MIT License](LICENSE)

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issues å’Œ Pull Requests æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

---

**æ³¨æ„**: è¿™ä¸ªé¡¹ç›®è®¾è®¡ç”¨äºçœŸå®çš„ç”Ÿäº§ç¯å¢ƒï¼Œæ”¯æŒæ•°åƒäººåŒæ—¶è®¿é—®ã€‚åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå‰ï¼Œè¯·ç¡®ä¿è¿›è¡Œå……åˆ†çš„æµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ–ã€‚